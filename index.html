<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Home</title>
<link rel="icon" type="image/x-icon" href="assets/GoogleClassroomIcon.ico">
<style>
/* --- Global Styles --- */
*, *::before, *::after { box-sizing: border-box; }

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: Arial, sans-serif;
  background: #fff;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  overflow-x: hidden;
}

/* --- Login Screen --- */
#loginScreen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  font-family: Arial, sans-serif;
}
#loginScreen input {
  padding: 10px;
  font-size: 16px;
  margin: 10px;
}
#loginScreen button {
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}

/* --- Hide Main Content Initially --- */
#mainHeader, #mainMenu, #mainFooter {
  display: none;
}

/* --- Header --- */
header {
  background: #2c7be5;
  color: white;
  padding: 12px;
  font-weight: bold;
  font-size: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.header-center {
  display: flex;
  align-items: center;
  gap: 8px;
}
header img { height: 24px; vertical-align: middle; }
.back-button, #helpButton {
  border: none;
  padding: 6px 12px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: bold;
}
.back-button {
  background: red;
  color: white;
  display: none;
}
#helpButton {
  background: #ffc107;
  color: black;
}

/* --- Main Menu --- */
.games-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  padding: 20px;
  flex: 1;
}
.game-card {
  background: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  cursor: pointer;
  transition: transform 0.2s;
  display: flex;
  flex-direction: column;
}
.game-card:hover { transform: scale(1.05); }
.game-thumbnail { width: 100%; height: 150px; object-fit: cover; }
.game-info { display: flex; align-items: center; padding: 10px; }
.game-info img { width: 24px; height: 24px; margin-right: 10px; }

/* --- Game Screen --- */
.game-screen {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: white;
  padding: 20px 0;
  flex: 1;
  width: 100%;
}
.game-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 0 10px;
}
.game-container-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
}
.game-container {
  border: 12px solid #2c7be5;
  border-radius: 24px;
  width: 80vw;
  height: 80vh;
  max-width: 1500px;
  max-height: 844px;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  position: relative;
}
.game-container iframe {
  width: 100%;
  height: 100%;
  border-radius: 12px;
}

/* --- Overlay / Loading --- */
.overlay {
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: 12px;
  cursor: pointer;
  z-index: 5;
  color: white;
  font-size: 18px;
  font-weight: bold;
  background: rgba(0,0,0,0.4);
  transition: background 0.3s ease;
  text-shadow: 0 0 5px black;
}
.overlay:hover { background: rgba(0,0,0,0.6); }
.loading-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.8);
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  font-size: 18px;
  z-index: 10;
}
.spinner {
  border: 6px solid #f3f3f3;
  border-top: 6px solid #2c7be5;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin-bottom: 15px;
}
@keyframes spin { 100% { transform: rotate(360deg); } }

/* --- Fullscreen Button --- */
.fullscreen-btn {
  margin-top: 5px;
  background: #2c7be5;
  color: white;
  padding: 8px 14px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  font-size: 14px;
  font-weight: bold;
  display: none;
}

/* --- Footer --- */
footer {
  background: #2c7be5;
  color: white;
  text-align: center;
  padding: 12px;
  font-weight: bold;
  margin-top: auto;
}

/* --- Hidden --- */
.hidden { opacity: 0; pointer-events: none; }

/* --- Help Modal --- */
#helpModal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  z-index: 2000;
  justify-content: center;
  align-items: center;
}
#helpModalContent {
  background: white;
  padding: 20px;
  border-radius: 12px;
  width: 90%;
  max-width: 600px;
  max-height: 80%;
  overflow-y: auto;
  position: relative;
}
#helpModalContent button {
  position: absolute;
  top: 10px;
  right: 10px;
  background: red;
  color: white;
  border: none;
  border-radius: 12px;
  padding: 6px 10px;
  cursor: pointer;
  font-weight: bold;
}
</style>
</head>
<body>

<!-- Login Screen -->
<div id="loginScreen">
  <h2>üîí Enter Password to Access Game Hub</h2>
  <input type="password" id="passwordInput" placeholder="Password">
  <button onclick="checkPassword()">Unlock</button>
</div>

<!-- Main Content -->
<header id="mainHeader">
  <div><button class="back-button" id="backButton" onclick="backToHub()">‚¨Ö Back</button></div>
  <div class="header-center">AMES</div>
  <div><button id="helpButton">‚ùì Help</button></div>
</header>

<div id="mainMenu" class="games-grid"></div>

<div id="gameScreen" class="game-screen">
  <div class="game-wrapper">
    <div class="game-container-wrapper">
      <div class="game-container">
        <div id="iframeOverlay" class="overlay">‚ñ∂ Play</div>
        <div id="loadingOverlay" class="loading-overlay">
          <div class="spinner"></div>
          Loading Please Wait...
        </div>
        <iframe id="gameFrame"></iframe>
      </div>
      <button onclick="toggleFullscreen()" id="fullscreenBtn" class="fullscreen-btn">‚õ∂ Fullscreen</button>
    </div>
  </div>
</div>

<footer id="mainFooter">Made by POWBoy1</footer>

<div id="helpModal">
  <div id="helpModalContent">
    <h2>üéÆ How to Use POWBoy1‚Äôs Game Hub</h2>
    <ol>
      <li><b>Browse Games:</b> Click any game card.</li>
      <li><b>Play:</b> Press ‚ñ∂ Play on the overlay.</li>
      <li><b>Fullscreen:</b> Use ‚õ∂ Fullscreen (exit with Escape/‚ùå/Done).</li>
      <li><b>Back:</b> Use ‚¨Ö Back to return to the hub.</li>
    </ol>
        <button id="closeHelp">‚úñ Close</button>
  </div>
</div>

<script>
// ===== Password Protection =====
function checkPassword() {
  const input = document.getElementById("passwordInput").value;
  if (input === "chicken") {
    document.getElementById("loginScreen").style.display = "none";
    document.getElementById("mainHeader").style.display = "flex";
    document.getElementById("mainMenu").style.display = "grid";
    document.getElementById("mainFooter").style.display = "block";
  } else {
    alert("Incorrect password. Try again.");
  }
}

// ===== Device & WebGL checks =====
function blockWithMessage(msg) {
  document.body.innerHTML = `<div style="display:flex;justify-content:center;align-items:center;
    height:100vh;font-family:Arial,sans-serif;font-size:20px;font-weight:bold;
    text-align:center;padding:20px;flex-direction:column;">${msg}</div>`;
}
function isAppleMobile() {
  const ua = navigator.userAgent || navigator.vendor || window.opera;
  return /iPad|iPhone|iPod/.test(ua) && !window.MSStream;
}
function supportsWebGL() {
  try {
    const canvas = document.createElement("canvas");
    return !!(window.WebGLRenderingContext &&
      (canvas.getContext("webgl") || canvas.getContext("experimental-webgl")));
  } catch (e) { return false; }
}
if (isAppleMobile()) {
  blockWithMessage("‚ùå Sorry, this Game Hub is not supported on iPhone/iPad/iPod. ‚ùå<br><br>Please use macOS or another supported device.");
} else if (!supportsWebGL()) {
  blockWithMessage("‚ö†Ô∏è Your browser/device does not support WebGL. ‚ö†Ô∏è<br><br>If you think this is a bug, please test at <a href='https://get.webgl.org/' target='_blank'>get.webgl.org</a>.");
}

// ===== Game hub logic =====
const placeholderIcon = "assets/holder-icon.png";
const placeholderThumb = "assets/holder-thumb.png";
const mainMenu = document.getElementById("mainMenu");
const gameScreen = document.getElementById("gameScreen");
const gameFrame = document.getElementById("gameFrame");
const iframeOverlay = document.getElementById("iframeOverlay");
const loadingOverlay = document.getElementById("loadingOverlay");
const mainHeader = document.getElementById("mainHeader");
const backButton = document.getElementById("backButton");
const helpButton = document.getElementById("helpButton");
const mainFooter = document.getElementById("mainFooter");
const fullscreenBtn = document.getElementById("fullscreenBtn");
const helpModal = document.getElementById("helpModal");
const closeHelp = document.getElementById("closeHelp");

helpButton.onclick = () => helpModal.style.display = "flex";
closeHelp.onclick = () => helpModal.style.display = "none";
helpModal.onclick = e => { if(e.target===helpModal) helpModal.style.display="none"; };

fetch("https://raw.githubusercontent.com/POWBoy1/GameHubUpdater/refs/heads/main/games.json")
.then(res=>res.json())
.then(renderGames)
.catch(err=>{console.error(err); mainMenu.innerHTML="<p style='color:red'>Failed to load game list.</p>";});

function renderGames(games){
  mainMenu.innerHTML="";
  games.forEach(game=>{
    const card=document.createElement("div");
    card.className="game-card";
    card.innerHTML=`
      <img class="game-thumbnail" src="${game.thumbnail||placeholderThumb}" alt="${game.title}" onerror="this.src='${placeholderThumb}'">
      <div class="game-info">
        <img src="${game.icon||placeholderIcon}" alt="${game.title} icon" onerror="this.src='${placeholderIcon}'">
        <h3>${game.title}</h3>
      </div>
    `;
    card.onclick=()=>openGame(game);
    mainMenu.appendChild(card);
  });
}

function openGame(game){
  gameScreen.style.display="flex";
  mainMenu.style.display="none";
  backButton.style.display="inline-block";

  mainHeader.innerHTML = "";
  const left = document.createElement("div"); left.appendChild(backButton);
  const center = document.createElement("div"); center.className = "header-center";
  const icon = document.createElement("img"); icon.src = game.icon||placeholderIcon; icon.alt = game.title+" icon";
  const title = document.createElement("span"); title.textContent = game.title;
  center.appendChild(icon); center.appendChild(title);
  const right = document.createElement("div"); right.appendChild(helpButton);
  mainHeader.appendChild(left); mainHeader.appendChild(center); mainHeader.appendChild(right);

  iframeOverlay.style.background=`
    linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)),
    url('${game.thumbnail||placeholderThumb}') center/cover no-repeat
  `;
  iframeOverlay.style.display="flex";

  gameFrame.style.display="block";
  gameFrame.src="";
  loadingOverlay.style.display="none";
  fullscreenBtn.style.display="none";

  iframeOverlay.onclick=()=>{
    iframeOverlay.style.display="none";
    loadingOverlay.style.display="flex";
    gameFrame.src=game.url;
    localStorage.setItem("lastGame", game.url);
    gameFrame.onload=()=>{
      loadingOverlay.style.display="none";
      fullscreenBtn.style.display="block";
    };
  };
}

function backToHub(){
  gameScreen.style.display="none";
  mainMenu.style.display="grid";
  gameFrame.src="";
  gameFrame.style.display="none";
  iframeOverlay.style.display="none";
  loadingOverlay.style.display="none";
  backButton.style.display="none";
  fullscreenBtn.style.display="none";
  mainHeader.innerHTML = `<div></div><div class="header-center">üéÆ POWBoy1‚Äôs Game Hub üéÆ</div><div>${helpButton.outerHTML}</div>`;
  if(document.fullscreenElement) document.exitFullscreen();
}

function toggleFullscreen(){
  if(!document.fullscreenElement){
    if(gameFrame.requestFullscreen) gameFrame.requestFullscreen();
    else if(gameFrame.webkitEnterFullscreen) gameFrame.webkitEnterFullscreen();
  } else {
    if(document.exitFullscreen) document.exitFullscreen();
    else if(document.webkitExitFullscreen) document.webkitExitFullscreen();
  }
}

document.addEventListener("fullscreenchange",()=>{
  const fs=document.fullscreenElement===gameFrame;
  [mainHeader, mainFooter, backButton, helpButton].forEach(el=>el.classList.toggle("hidden",fs));
  fullscreenBtn.textContent=fs?"‚ùå Exit Fullscreen":"‚õ∂ Fullscreen";
});
document.addEventListener("webkitfullscreenchange",()=>{
  const fs=document.webkitFullscreenElement===gameFrame;
  [mainHeader, mainFooter, backButton, helpButton].forEach(el=>el.classList.toggle("hidden",fs));
  fullscreenBtn.textContent=fs?"‚ùå Exit Fullscreen":"‚õ∂ Fullscreen";
});
</script>
</body>
</html>
